<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>My Project: OWD Plugins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li><li class="navelem"><a class="el" href="news.html">OWD News</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OWD Plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>With OWD plugins you can extend the behavior of OWD without having to modify the distributed code. This allows you to easily stay on top of OWD updates, as well as share your improvements with other OWD users. Furthermore, the plugin architecture speeds the development cycle, since you do not have to recompile OWD every time you make a change.</p>
<h1><a class="anchor" id="plugin_what"></a>
What they can do</h1>
<p>Plugins for OWD have access to all of the sensor values and motion commands for the WAM, Barrett Hand, and Force/Torque sensor. They can directly interpolate sensor readings without the delays and bandwidth limitations of ROS messages, perform calculations using OWD's own internal functions, and command hand and arm motions in ways that are not supported by OWD's standard interfaces. Additionally, plugins can create their own ROS interfaces for publishing data, receiving external sensor values, and accepting custom service calls. In short, the plugin interface allows users to experiment with WAM control without having to modify OWD on their own.</p>
<h1><a class="anchor" id="plugin_how"></a>
How they work</h1>
<p>OWD plugins are simply Linux shared libraries that define the following two functions:</p>
<pre class="fragment">bool register_owd_plugin()
void unregister_owd_plugin()
</pre><p>Upon loading the plugin, OWD will call the register_owd_plugin function, which gives the plugin the opportunity to initialize itself and start running. Plugins interface with OWD through the OWD::Plugin class, which provides read-only copies of all the sensor values and functions for motion control of the arm and hand. Plugins can either make use of OWD's callback functionality for regular updates via the OWD::Plugin::Publish function, or they can create their own threads. Plugins can also create their own trajectory types and ask that OWD execute them. When OWD shuts down it will call the unregister_owd_plugin function so that the plugin can terminate its own ROS services and clean up.</p>
<p>Plugins are specified to OWD via the <b>~/owd_plugins</b> ROS parameter, which should contain a comma-separated list of shared libraries (full pathname recommended). OWD will send INFO level ROS log messages as each plugin is loaded and registered.</p>
<h1><a class="anchor" id="plugin_writing"></a>
Writing an OWD plugin</h1>
<p>A plugin should be created as its own ROS package, with a manifest-specified dependency on owd. The CMakeLists.txt file should contain a rosbuild_add_library() directive to create the shared library. As long as the library contains the functions register_owd_plugin and unregister_owd_plugin (described above), it will be compatible with OWD.</p>
<p>A typical plugin will include the following files:</p>
<pre class="fragment">#include &lt;openwam/Plugin.hh&gt;
#include &lt;openwam/Trajectory.hh&gt;
#include &lt;ros/ros.h&gt;
</pre><p>This will give the plugin access to the OWD::Plugin class (for interfacing to OWD) and the OWD::Trajectory class (for deriving custom OWD trajectories). For automatic periodic calls to the plugin, users can subclass the OWD::Plugin class and override the Publish() function. Your Publish() function will be called at the rate defined by OWD ROS parameter <b>~/publish_frequency</b>. In this way you can perform your own calculations on the WAM state and publish the values to other ROS nodes or even to non-ROS clients.</p>
<p>Custom trajectories are defined by subclassing the OWD::Trajectory class. Typically, a plugin will create its own ROS service for handling trajectory requests, which will create trajectory instances and add them to the OWD queue. Once OWD begins execution of the trajectory, it will call the evaluate function until the trajectory transitions from state RUN to state DONE. Although a trajectory is usually thought of as a timed path from start_position to end_position, it can also be a long-running behavior that, for instance, servos the WAM based on sensor data that you are receiving on a ROS topic. Or a trajectory could be a data-gathering device for recording positions and forces while a user manually moves the arm.</p>
<p>A good practice is to tie the ROS topic / service handlers to the classes that use them. Thus, a user's own Trajectory class might define a static AddTrajectory() member that services new trajectory requests. In this way all the code related to creating and running the trajectory is contained within a single class.</p>
<h1><a class="anchor" id="plugin_examples"></a>
Example plugin</h1>
<p>The <a href="http://personalrobotics.ri.cmu.edu/intel-pkg/owd_plugin_example/html/index.html">owd_plugin_example</a> node is a fully documented sample OWD plugin which users are encouraged to modify as a starting point for their own plugins.</p>
<pre class="fragment">Copyright 2011-2012 Carnegie Mellon University and Intel Corporation
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 29 2017 14:35:01 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
