<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>My Project: Barrett Hand</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Barrett Hand </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>For historical reasons we have a separate node, "bhd", for controlling the 262 hand. When the 280 hand came out it required integrating the hand CANbus commands into OWD, so when OWD is configured for a 280 hand it also mimics a BHD node (which is why the hand services are all prefixed with "bhd/" instead of "owd/").</p>
<dl class="section note"><dt>Note</dt><dd>We run a mixed environment on Herb with no problems at all: OWD plus BHD for the left arm (which has a 262 hand), and OWD alone for the right arm (with a 280 hand). There is no discernible difference for the clients which communicate with them.</dd></dl>
<h1><a class="anchor" id="parameters"></a>
Parameters</h1>
<ul>
<li><b>~/hand_type</b> Type of hand installed. Should be one of:<ul>
<li><b>260</b> For a BH260 Hand (serial communication)</li>
<li><b>280</b> For a BH280 Hand (CANbus communication)</li>
<li><b>280+TACT</b> For a BH280 Hand with the fingertip tactile arrays installed</li>
<li><b>none</b> For no hand installed</li>
</ul>
</li>
<li><b>~/hand_publish_frequency</b> Rate at which the handstate messages are published, in hertz, if a model 280 hand is installed. Default is 10, max is 40.</li>
<li><b>~/tactile_publish_frequency</b> Rate at which the tactile messages are published, in hertz. Default is 10, max is 40.</li>
<li><b>~/tactile_top10</b> If set to <em>true</em> will only report 4-bit values for the 10 ten pressures in each tactile array. Default is <em>false</em> (all values are reported as 12-bit numbers). Setting to <em>true</em> reduces the communication demands on the CAN bus, but does not increase the maximum frequency that the sensors can be read, since most of the time is waiting for the hand pucks to gather the tactile data.</li>
</ul>
<h1><a class="anchor" id="services"></a>
Services</h1>
<ul>
<li><b>/bhd/GetHandDOF</b>: type: <em>owd_msgs/GetDOF</em>. Get the number of degrees of freedom of the hand.</li>
<li><b>/bhd/MoveHand</b>: type: <em>owd_msgs/MoveHand</em>. Move the hand in either position or velocity mode.</li>
<li><b>/bhd/RelaxHand</b>: type: <em>owd_msgs/RelaxHand</em>. Idle the hand pucks.</li>
<li><b>/bhd/ResetHand</b>: type: <em>owd_msgs/ResetHand</em>. Send the HI (Hand Initialize) command to each hand puck, in the sequence 1, 2, 3, 1, 2, 3, 1, 2, 3, 4 (allows the hand to fully unfold if fingers are blocking one-another in the worst-case configuration). The HI command is the only guaranteed way to clear the breakaway condition.</li>
<li><b>/bhd/ResetHandQuick</b>: type: <em>owd_msgs/ResetHand</em>. Send the HI (Hand Initialize) command to each hand puck and the spread puck simultaneously. This command will work for most, but not every hand configuration. The HI command is the only guaranteed way to clear the breakaway condition.</li>
<li><b>/bhd/ResetFinger</b>: type: <em>owd_msgs/ResetFinger</em>. Send the HI command to a single specified finger (1 through 4).</li>
<li><b>/bhd/GetProperty</b>: type: <em>owd_msgs/GetHandProperty</em>. Get a bhand property. See CANbus::initPropertyDefs for a list of property values.</li>
<li><b>/bhd/SetProperty</b>: type: <em>owd_msgs/SetHandProperty</em>. Set a bhand property. See CANbus::initPropertyDefs for a list of property values.</li>
<li>The model 280 hand uses pucks to control the motors, the same as for the arm joints. Barrett has some documentation on the CANbus communication here: <a href="http://web.barrett.com/support/Puck_Documentation/CAN_Message_Format.pdf">http://web.barrett.com/support/Puck_Documentation/CAN_Message_Format.pdf</a>. And the full list of puck property names and values is in the CANbus::initPropertyDefs function in openwam/CANbus.cc. Many of these are only applicable for arm pucks, and some only for the safety puck, but many (like P/AP and MT) are shared between both arm and hand pucks. The hand pucks have a rudimentary imitation of the original 262 protocol, in that you can send a few different command values (like HI or M) to the pucks CMD property. But for the most part you treat them like arm pucks.</li>
<li><b>/bhd/SetSpeed</b>: type: <em>owd_msgs/SetSpeed</em>. Set the speed that the hand will use for a /bhd/MoveHand position command. The velocities vector should have four values in units of radians per second (three for the fingers, one for the spread). The default values for the 280 hand are 2.5 for the fingers and 4.3 for the spread. The min_accel_time field in the service message is ignored.</li>
<li><b>/bhd/SetHandTorque</b>: type: <em>owd_msgs/SetHandTorque</em>. Set the torques that the hand will use for the position moves. The <b>initial</b> value will be used for the start of each move, and if the finger gets stalled before it reaches its destination the torque will drop to the <b>sustained</b> level. Default is 2200 / 1100; do not exceed these defaults or you will risk overheating the hand. If you want to keep the torques below the breakaway torques, try setting them to 1200/1100.</li>
</ul>
<h1><a class="anchor" id="topics"></a>
Topics</h1>
<ul>
<li><b>/bhd/handstate</b>: type: <em>owd_msgs/BHState</em>. Publishes the state of the hand at the frequency set by the <b>~/hand_publish_frequency</b> parameter. Includes the following fields:<ul>
<li>float64[] <b>positions:</b> The angle of each inner link, in radians, if the finger is <em>not</em> in breakaway. This is the same angle that the motor tries to seek to when commanding positions. Once the finger goes into the breakaway state, the inner link stops moving, and this field no longer directly reflects any physical position. With the advent of the inner link encoders on the 280 hand, the inner_links and outer_links fields have superceded this field, but it has been kept for backwards compatibility. Eventually this should be changed to reflect the outer link angle relative to the palm plane, which is always valid even without the inner link encoders, and which could be matched by the position command values.</li>
<li>float64[] <b>inner_links:</b> The true angle of each inner link, in radians, relative to the palm plane (range of 0 to 2.44). This value is accurate at all times (including the breakaway state). The value is reported for the three fingers only if the hand is equipped with inner-link encoders; otherwise this array will be empty.</li>
<li>float64[] <b>outer_links:</b> The angle of each outer link, in radians, relative to the inner link (range of 0.73 to 1.57). This value is accurate at all times (including the breakaway state). The value is reported for the three fingers only if the hand is equipped with inner-link encoders; otherwise this array will be empty.</li>
<li>bool[] <b>breakaway:</b> True if the finger is in the breakaway state, detected by watching the ratio of the motor encoder value to the inner link encoder value. Once the breakaway flag has been set, it remains set until the finger is reset with the ResetHand or ResetFinger service calls. While this flag is set, OWD will not repeat movement commands that stop short of their goal, since it may be due to the reduced motion limits during breakaway. If the hand is not equipped with inner link encoders this array will be empty.</li>
<li>float64[] <b>strain:</b> The strain gauge readings for each of the three fingers.</li>
<li>float32 <b>temperature:</b> Not used. The BHD node, which controls a model 262 hand, populates this field with the temperature of the controller board. This needs to be updated for the 280 hand to report the temps of each of the pucks and their motors.</li>
<li>uint8 <b>state:</b> The motion state of the hand, calculated by aggregating together the states of each of the four motors. Values are in the BHState.msg file.</li>
<li>uint8[] <b>internal_state:</b> The individual state of each of the motors. Eventually this will become the only state field, and the existing state field will be removed.</li>
<li>uint8[] <b>puck_mode:</b> The MODE value for each of the pucks. Useful for debugging protocol problems.</li>
</ul>
</li>
<li><b>/owd/tactile</b>: type: <em>owd_msgs/BHTactile</em>. Data from the tactile sensors on the model BH280 hand. Each finger's values are given in units of N/cm^2. The numbering of each array matches the documentation provided by Barrett. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 29 2017 14:35:01 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
